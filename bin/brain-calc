#!/usr/bin/env php

<?php

$autoloadPath1 = __DIR__ . '/../../../autoload.php';
$autoloadPath2 = __DIR__ . '/../vendor/autoload.php';

if (file_exists($autoloadPath1)) {
    require_once $autoloadPath1;
} else {
    require_once $autoloadPath2;
}

require_once __DIR__ . '/../src/Engine.php';

use function cli\line;
use function cli\prompt;

$name = Engine\sayHello();
$question = 'What is the result of the expression?';
Engine\explainRules($question);

$correctAnswersCount = 0;

while ($correctAnswersCount < Engine\ROUNDS) {
    $num1 = rand(0, 100);
    $num2 = rand(0, 100);

    $operations = ['+', '*'];
    $currentOperation = $operations[array_rand($operations)];
    $content = "{$num1} {$currentOperation} {$num2}";
    Engine\askQuestion($content);

    if ($currentOperation === '+') {
        $correctAnswer = $num1 + $num2;
    } else {
        $correctAnswer = $num1 * $num2;
    }

    $currentAnswer = Engine\getAnswer();

    if (Engine\checkAnswer($currentAnswer, $correctAnswer, $name)) {
        $correctAnswersCount++;
    } else {
        return;
    }
}

Engine\congratulate($name);